#!/bin/sh

{{ java_bin }} -cp ".:lib/*" \
    -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true \
    -Xmx2048m \
    -XX:+HeapDumpOnOutOfMemoryError \
    -XX:HeapDumpPath=./logs \
    -Dfile.encoding=UTF8 \
    -XX:NativeMemoryTracking=detail \
    -XX:+UnlockDiagnosticVMOptions \
    -XX:+PrintNMTStatistics \
    -Dlogback.configurationFile=conf/logback.xml \
    -Dio.netty.noUnsafe=true \
    -Djdk.nio.maxCachedBufferSize=262144 \
    -Djava.net.preferIPv4Stack=true \
    -Djava.library.path=./:./bin:./bin/native/darwin \
    -Dcom.sun.management.jmxremote \
    -Dcom.sun.management.jmxremote.port={{ jmx_port }} \
    -Dcom.sun.management.jmxremote.ssl=false \
    -Dcom.sun.management.jmxremote.local.only=true \
    -Dcom.sun.management.jmxremote.authenticate=false \
    {{ extra_java_options | join(' ') }} \
    {{ main_class }}
